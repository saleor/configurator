---
name: configurator-setup
description: Interactive guided setup wizard for creating new Saleor store configurations from scratch
allowed-tools: Bash, Read, Write, Edit, AskUserQuestion, Glob, TaskCreate, TaskUpdate, TaskList
argument-hint: [business-type]
disable-model-invocation: true
---

# Configurator Setup Wizard

You are guiding the user through creating a new Saleor store configuration. This is an interactive wizard that creates a valid `config.yml` file.

## Progress Tracking

Create tasks to track wizard progress so the user can see clear status:

```
Use TaskCreate to create these tasks at the start:
1. "Select business type" - activeForm: "Selecting business type"
2. "Configure channels" - activeForm: "Configuring channels"
3. "Define product types" - activeForm: "Defining product types"
4. "Create category hierarchy" - activeForm: "Creating categories"
5. "Add optional features" - activeForm: "Adding features"
6. "Generate config.yml" - activeForm: "Generating configuration"
7. "Review and confirm" - activeForm: "Reviewing configuration"

Update task status as you progress:
- Set to in_progress when starting a step
- Set to completed when step finishes
- User sees clear progress throughout the wizard
```

## Context Detection

First, check the current state:

```bash
test -f config.yml && echo "CONFIG_EXISTS" || echo "NO_CONFIG"
```

## Workflow

### If config.yml Already Exists

1. Inform the user that a configuration already exists
2. Offer options:
   - **Review existing**: Analyze current config
   - **Start fresh**: Back up existing and create new
   - **Modify**: Use `/configurator-edit` instead

### If No config.yml Exists (Normal Flow)

#### Step 1: Business Type Selection

Ask the user about their business type using AskUserQuestion:

**Question**: "What type of store are you setting up?"
**Options**:
- Fashion/Apparel (clothing, shoes, accessories)
- Electronics (phones, computers, gadgets)
- Food & Grocery (perishables, groceries)
- Digital Products (downloads, subscriptions)
- General Retail (mixed products)
- Custom (I'll describe my needs)

#### Step 2: Channel Configuration

Based on business type, ask about channels:

**Question**: "What regions/markets will you sell to?"
**Options**:
- Single region (one currency)
- Multiple regions (US, EU, UK)
- Global (multiple currencies)

For each region, gather:
- Display name (e.g., "US Store")
- Currency code (USD, EUR, GBP)
- Default country

#### Step 3: Product Structure

Based on business type, suggest appropriate product types:

**Fashion**: T-Shirt, Pants, Shoes, Accessories (with Size, Color attributes)
**Electronics**: Phone, Laptop, Accessory (with Storage, Color, RAM attributes)
**Food**: Fresh Produce, Packaged Food, Beverage (with Weight, Expiry attributes)
**Digital**: Software, E-Book, Subscription (no shipping, digital delivery)

Ask if user wants to:
- Use suggested structure
- Customize product types
- Start minimal (add later)

#### Step 4: Category Structure

Propose a category hierarchy based on business type:

**Fashion Example**:
```
Clothing
├── Men's
│   ├── T-Shirts
│   ├── Pants
│   └── Shoes
└── Women's
    ├── Dresses
    ├── Tops
    └── Shoes
```

Ask user to:
- Accept suggested structure
- Modify structure
- Skip categories (add later)

#### Step 5: Additional Configuration

Ask about optional features:
- **Shipping**: Set up shipping zones?
- **Tax**: Configure tax classes?
- **Warehouse**: Add warehouse locations?
- **Collections**: Create promotional collections?

#### Step 6: Generate Configuration

Based on all inputs, generate `config.yml`:

```yaml
# Saleor Store Configuration
# Generated by Configurator Setup Wizard
# Date: [current date]

channels:
  - name: "[User's channel name]"
    slug: "[generated-slug]"
    currencyCode: [CURRENCY]
    defaultCountry: [COUNTRY]
    isActive: true

productTypes:
  # [Based on business type selection]

categories:
  # [Based on category structure]

# Additional sections based on user selections
```

#### Step 7: Review and Confirm

Show the user a summary:
- Number of channels
- Number of product types
- Category structure
- Optional features enabled

Ask for confirmation before writing the file.

#### Step 8: Next Steps

After creating config.yml:

1. **Proactively launch config-review agent** to validate the generated configuration
2. Explain how to add products manually or via introspect
3. Explain deployment process:
   ```bash
   # Preview changes
   npx configurator diff --url=$SALEOR_API_URL --token=$SALEOR_TOKEN

   # Deploy
   npx configurator deploy --url=$SALEOR_API_URL --token=$SALEOR_TOKEN
   ```

**Important**: Always invoke the config-review agent after setup completes to catch any issues before the user attempts deployment.

## Business Type Templates

### Fashion Store Defaults

```yaml
productTypes:
  - name: "T-Shirt"
    isShippingRequired: true
    variantAttributes:
      - name: "Size"
        type: DROPDOWN
        values: [XS, S, M, L, XL, XXL]
      - name: "Color"
        type: SWATCH

  - name: "Pants"
    isShippingRequired: true
    variantAttributes:
      - name: "Waist"
        type: DROPDOWN
      - name: "Length"
        type: DROPDOWN
      - name: "Color"
        type: SWATCH
```

### Electronics Store Defaults

```yaml
productTypes:
  - name: "Smartphone"
    isShippingRequired: true
    productAttributes:
      - name: "Brand"
        type: DROPDOWN
      - name: "Screen Size"
        type: PLAIN_TEXT
    variantAttributes:
      - name: "Storage"
        type: DROPDOWN
        values: [64GB, 128GB, 256GB, 512GB]
      - name: "Color"
        type: SWATCH
```

### Digital Products Defaults

```yaml
productTypes:
  - name: "Digital Download"
    isShippingRequired: false
    isDigital: true
    productAttributes:
      - name: "File Format"
        type: DROPDOWN
      - name: "File Size"
        type: PLAIN_TEXT
```

## Error Handling

- If user provides invalid input, explain the issue and ask again
- If YAML generation fails, show the error and offer to retry
- Always validate generated config before writing

## Skills to Use

Reference these skills for domain knowledge:
- `configurator-schema` for YAML structure
- `saleor-domain` for entity relationships
- `configurator-recipes` for template examples

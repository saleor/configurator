{
  "description": "Saleor Configurator plugin hooks for context detection, validation, and deployment safety",
  "hooks": {
    "SessionStart": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "bash ${CLAUDE_PLUGIN_ROOT}/hooks/scripts/session-context.sh",
            "timeout": 10
          }
        ]
      }
    ],
    "PreToolUse": [
      {
        "matcher": "Write|Edit",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "If the file being written/edited is config.yml or ends with .yml/.yaml in the current working directory:\n\n1. Validate YAML syntax - check for indentation errors, missing colons, invalid characters\n2. If syntax is invalid, respond with: {\"decision\": \"block\", \"reason\": \"YAML syntax error: [specific error description]\"}\n3. If syntax is valid, respond with: {\"decision\": \"allow\"}\n\nFor non-YAML files, respond with: {\"decision\": \"allow\"}"
          }
        ]
      },
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "If the bash command contains 'configurator deploy' or 'pnpm dev deploy':\n\n1. Check if this is a dry-run (--dry-run flag present) - if so, respond {\"decision\": \"allow\"}\n2. Check if the user has been warned about potential deletions in this conversation\n3. If this is a real deployment (not dry-run) and deletions haven't been discussed, respond with:\n   {\"decision\": \"block\", \"reason\": \"Deployment may modify your Saleor store. Please run with --dry-run first to preview changes, or confirm you understand changes will be applied.\"}\n4. Otherwise respond {\"decision\": \"allow\"}\n\nFor non-deploy bash commands, respond {\"decision\": \"allow\"}"
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Write|Edit",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "If config.yml was just modified:\n\n1. Note that the configuration has changed\n2. Suggest: \"Configuration updated. Would you like me to run a diff to preview what will change on your Saleor instance?\"\n3. This is non-blocking - the user can decline\n\nRespond with a brief, helpful message about next steps."
          }
        ]
      },
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "If the bash command was 'configurator deploy' or 'pnpm dev deploy', analyze the output:\n\n**On Success:**\n- Summarize changes: count of created, updated, deleted entities by type\n- Suggest verifying changes in Saleor Dashboard\n- Recommend running introspect to update local config if needed\n\n**On Failure:**\n- Identify the error type (validation, auth, network, GraphQL)\n- Provide specific guidance based on error\n- Offer to run the troubleshoot agent for deeper analysis\n\nProvide a concise, actionable summary."
          }
        ]
      }
    ]
  }
}

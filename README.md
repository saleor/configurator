# Saleor Configurator

A powerful TypeScript-based infrastructure-as-code tool for managing Saleor e-commerce configurations declaratively.

## üìö Documentation

- **[Quick Start Guide](./QUICK_START.md)** - Get up and running in 5 minutes
- **[Complete Module Documentation](./MODULES_DOCUMENTATION.md)** - Detailed guide for all modules
- **[AI/LLM Reference](./AI_LLM_INDEX.md)** - Structured documentation for AI assistants and IDE integration
- **[Integration Guide](./INTEGRATION.md)** - How to integrate configurator with Saleor

## üéØ Overview

The Saleor Configurator enables you to:
- Define your entire e-commerce setup in YAML
- Version control your store configuration
- Automate deployment across environments
- Ensure consistency and reproducibility

## ‚ú® Features

- **Declarative Configuration**: Define desired state, not imperative steps
- **Idempotent Operations**: Safe to run multiple times
- **Dependency Management**: Automatically handles entity relationships
- **Type Safety**: Full TypeScript support with runtime validation
- **Comprehensive Coverage**: Supports all major Saleor entities

## üöÄ Quick Start

```bash
# Install dependencies
pnpm install

# Configure environment
cp .env.example .env
# Edit .env with your Saleor credentials

# Create your configuration
cat > my-store.yml << 'EOF'
shop:
  defaultMailSenderName: "My Store"
  
channels:
  - name: Poland
    currencyCode: PLN
    defaultCountry: PL
    slug: poland
    settings:
      allocationStrategy: PRIORITIZE_SORTING_ORDER
      automaticallyConfirmAllNewOrders: true
      automaticallyFulfillNonShippableGiftCard: true
      expireOrdersAfter: 30
      deleteExpiredOrdersAfter: 60
      markAsPaidStrategy: TRANSACTION_FLOW
      allowUnpaidOrders: false
      includeDraftOrderInVoucherUsage: true
      useLegacyErrorFlow: false
      automaticallyCompleteFullyPaidCheckouts: true
      defaultTransactionFlowStrategy: AUTHORIZATION

productTypes:
  - name: Book
    attributes:
      - name: Author
        inputType: PLAIN_TEXT
      - name: Genre
        inputType: DROPDOWN
        values:
          - name: Fiction
          - name: Non-Fiction
          - name: Fantasy
      - name: Related Books
        inputType: REFERENCE
        entityType: PRODUCT


pageTypes:
  - name: Blog Post
    attributes:
      - name: Title
        inputType: PLAIN_TEXT
      - name: Description
        inputType: PLAIN_TEXT
      - name: Published Date
        inputType: DATE
      - name: Related Posts
        inputType: REFERENCE
        entityType: PAGE

categories:
  - name: "Fiction"
    subcategories:
      - name: "Fantasy"
  - name: "Non-Fiction"
    subcategories:
      - name: "Science"
      - name: "History"
```

> [!TIP]
> See [SCHEMA.md](SCHEMA.md) for schema documentation with all the available properties.

## Development

### Installing dependencies

```bash
pnpm install
```

This will install the dependencies and fetch the Saleor schema needed for [gql.tada](https://gql-tada.0no.co/) to generate the types.

### Schema Documentation

The configuration schema is automatically documented from Zod schemas with GraphQL field mappings. The `SCHEMA.md` file is automatically regenerated by CI when schema files change.

**Manual generation** (if needed):
```bash
pnpm run generate-docs
```

The documentation includes:
- GraphQL field mappings for each configuration option
- Field types and required/optional status
- Enum values and examples
- Proper markdown structure with table of contents

### Versioning

This project uses [Changesets](https://github.com/changesets/changesets) for version management and changelog generation.

Please execute the following command when making changes that should be released:

```bash
# Document your changes
pnpm changeset
```

**Automated workflow:**

1. PRs require changesets (enforced by CI)
2. When PRs with changesets are merged, a Release PR is automatically created
3. Merging the Release PR finalizes the version and creates a GitHub release

**Skip changesets:** Add the `skip-changeset` label to PRs that don't need versioning (docs, tests, internal changes).

## Commands

### `pnpm push`

Reads the configuration file from a given path and creates/updates the data models in Saleor.

#### Options

- `--url` (required): The URL of the Saleor instance
- `--token` (required): App token with necessary permissions  
- `--config` (optional): Path to configuration file (defaults to `config.yml`)

#### Usage

```bash
# Basic usage
pnpm push --url="https://your-store.saleor.cloud/graphql/" --token="your-app-token"

# With custom config file
pnpm push --url="https://your-store.saleor.cloud/graphql/" --token="your-app-token" --config="production.yml"
```

Currently, it supports:

- [x] Creating attributes
- [x] Creating product types with attributes
- [x] Creating page types with attributes
- [x] Creating channels
- [x] Reading the configuration from config.yml file
- [x] Creating and updating channels with settings (payment, stock, order, checkout)
- [x] Updating shop settings
- [ ] Creating channels with warehouses
- [ ] Creating channels with warehouses and shipping zones
- [ ] Creating products
- [ ] Creating products with variants
- [ ] Creating discounts
- [ ] Categories
  - [x] Creating categories
  - [x] Creating categories with subcategories
  - [ ] Creating categories with products
- [ ] Collections
  - [ ] Creating collections
  - [ ] Creating collections with products

### `pnpm pull`

Retrieves the configuration from the Saleor instance and saves it to a file under the given path.

#### Options

- `--url` (required): The URL of the Saleor instance
- `--token` (required): App token with necessary permissions  
- `--config` (optional): Path to configuration file (defaults to `config.yml`)

#### Usage

```bash
# Run tests
pnpm test

# Run with debug logging
LOG_LEVEL=debug pnpm run push

# Type checking
pnpm tsc --noEmit
```

## üìÑ License

MIT License - see [LICENSE](./LICENSE) file for details.

## ü§ù Contributing

Contributions are welcome! Please:
1. Follow the existing patterns
2. Add tests for new functionality
3. Update documentation
4. Ensure all tests pass

## üìû Support

- Check the [documentation](./MODULES_DOCUMENTATION.md)
- Review [test files](./src/modules/) for examples
- Enable debug logging for troubleshooting
- Refer to [Saleor documentation](https://docs.saleor.io/)

---

Built with ‚ù§Ô∏è for the Saleor community
